<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Scripting for interpolation &mdash; RoboFab 599 documentation</title>
    
    <link rel="stylesheet" href="../_static/robofab.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '599',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="RoboFab 599 documentation" href="../index.html" />
    <link rel="up" title="Step-by-step" href="index.html" />
    <link rel="next" title="Scripting for production" href="session6.html" />
    <link rel="prev" title="Kerning and building Glyphs" href="session3.html" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>


  </head>
  <body role="document">
<div id='header'>
<!--<h1><a href="../index.html">RoboFab</a></h1>-->
<a href='#'>
    <img id='map-link' src="../_static/_img/logo.gif" />
</a>
</div>

<!-- horizontal -->


<div class="navbar">

<ul>
<li><a href="../index.html">home</a> </li>
<!--
<li><a href="../content/quickReference.html">reference</a></li>
-->
<li><a href="../intro/download.html">download</a></li>
<li><a href="../genindex.html">index</a></li>
</ul><div id="searchbox" style="display: none">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>

</div>



      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objects/index.html">Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howtos/index.html">How To&#8217;s</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Step-by-step</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Docs</a></li>
</ul>


  <div class="canhide">
    <h4>Previous</h4>
    <p class="topless">
      <a href="session3.html" title="previous chapter">Kerning and building Glyphs</a>
    </p>
  </div>
  <div class="canhide">
    <h4>Next</h4>
    <p class="topless">
      <a href="session6.html" title="next chapter">Scripting for production</a>
    </p>
  </div><div id="searchbox" style="display: none">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>


    <div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body" id="content">

  <div class="section" id="scripting-for-interpolation">
<h1>Scripting for interpolation<a class="headerlink" href="#scripting-for-interpolation" title="Permalink to this headline">¶</a></h1>
<img alt="../_images/RGlyph1.gif" src="../_images/RGlyph1.gif" />
<img alt="../_images/RFont1.gif" src="../_images/RFont1.gif" />
<div class="section" id="interpolation">
<h2>Interpolation<a class="headerlink" href="#interpolation" title="Permalink to this headline">¶</a></h2>
<p>In this session we&#8217;re going to look at scripting and interpolation. Building an interpolation system has 2 phases: <strong>preparing</strong> it and <strong>using</strong> it. Though this isn&#8217;t necessarily a design / production difference. In the first phase you need to make sure all the data is set up properly, the compatible glyphs in each master, matching contours in each glyph, path directions, start point locations etc. This can be a lot of work, but RoboFab can assist by reporting the problems. The second phase, using the interpolation comes when everything works and rather than look for problems (there shouldn&#8217;t be any) you just want to generate all the weights as fast as possible and get on with it proofing and other things.</p>
</div>
<div class="section" id="terminology">
<h2>Terminology<a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<p>The glyphs (or whole fonts) that are used in an interpolation system are usually called <strong>masters</strong>. The <strong>interpolation</strong> factor is a number between <code class="docutils literal"><span class="pre">0</span></code> and <code class="docutils literal"><span class="pre">1</span></code>. With <code class="docutils literal"><span class="pre">factor=0</span></code> the result will be identical to the first master (in this case glyph <code class="docutils literal"><span class="pre">A</span></code>), and as you can probably guess, with <code class="docutils literal"><span class="pre">factor=1</span></code> the result will match glyph <code class="docutils literal"><span class="pre">B</span></code>. <code class="docutils literal"><span class="pre">factor=0.5</span></code> means the resulting shape will be exactly between the two masters. The factor can actually also be outside the <code class="docutils literal"><span class="pre">0</span></code>, <code class="docutils literal"><span class="pre">1</span></code> range &#8211; in that case we speak of <strong>extrapolation</strong>. The particular change in a glyph when interpolating from one master to another is called an <strong>axis</strong>.</p>
</div>
<div class="section" id="why-use-robofab-interpolation">
<h2>Why use RoboFab interpolation?<a class="headerlink" href="#why-use-robofab-interpolation" title="Permalink to this headline">¶</a></h2>
<p>All the alternatives come with strings attached. FontLab&#8217;s <strong>Blend</strong> tool forces points in contours which don&#8217;t match. This is handy if you&#8217;re looking for a quick fix, but it can more or less destroy your masters. Alternatively you can use the Multiple Master tools, but this requires all of your masters to be in the same file and drawing this way can be tricky. Since interpolation is a useful process in typedesign, and a good candidate for scripting we decided to include solid interpolation support in Robofab.</p>
</div>
<div class="section" id="interpolating-glyphs">
<h2>Interpolating glyphs<a class="headerlink" href="#interpolating-glyphs" title="Permalink to this headline">¶</a></h2>
<p>In the first example we&#8217;re going to interpolate two glyphs in the same font. This can be useful in the design stage, for sketching or testing. The result is stored in a third glyph. Note: if you want to run this example in FontLab, open a new, empty font. Use the circle tool to draw one circle in <code class="docutils literal"><span class="pre">A</span></code>, and again in <code class="docutils literal"><span class="pre">B</span></code>. Make sure these are different enough to tell what&#8217;s going on:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># robothon06</span>
<span class="c"># interpolate two glyphs in the same font</span>

<span class="kn">from</span> <span class="nn">robofab.world</span> <span class="kn">import</span> <span class="n">CurrentFont</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">CurrentFont</span><span class="p">()</span>
<span class="n">factor</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">f</span><span class="p">[</span><span class="s">&quot;C&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;A&quot;</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;B&quot;</span><span class="p">])</span>
<span class="n">f</span><span class="p">[</span><span class="s">&quot;C&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<div class="downloadlink"><a class="reference internal" href="../_downloads/interpol_00.py">open or download this file: interpol_00.py</a></div><p>You see there are 3 glyphs involved: the two masters (<code class="docutils literal"><span class="pre">A</span></code> and <code class="docutils literal"><span class="pre">B</span></code>) and a new glyph which is used to store the results. In this case the new glyph is stored as <code class="docutils literal"><span class="pre">C</span></code>, but it can be helpful to give it a more descriptive name. This is not very PostScript-like, but chances are these glyphs won&#8217;t make it to production anyway, so it&#8217;s not a problem. Notice that <code class="docutils literal"><span class="pre">interpolate()</span></code> is a method of the <code class="docutils literal"><span class="pre">Glyph</span></code> object. The <code class="docutils literal"><span class="pre">Font</span></code> object has an interpolate method as well, more about that later. The <a class="reference internal" href="../howtos/interpolate.html"><em>obligatory link</em></a> to the relevant RoboFab documentation.</p>
<p>Here&#8217;s the same script, but now it generates a range of interpolated glyphs, each with a better name which tells you which interpolation factor was used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># robothon06</span>
<span class="c"># interpolate two glyphs in the same font a bunch of times</span>

<span class="kn">from</span> <span class="nn">robofab.world</span> <span class="kn">import</span> <span class="n">CurrentFont</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">CurrentFont</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="n">i</span><span class="o">*.</span><span class="mi">1</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;result_</span><span class="si">%f</span><span class="s">&quot;</span><span class="o">%</span><span class="n">factor</span>
    <span class="k">print</span> <span class="s">&quot;interpolating&quot;</span><span class="p">,</span> <span class="n">name</span>
    <span class="n">f</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;A&quot;</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;B&quot;</span><span class="p">])</span>

<span class="n">f</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<div class="downloadlink"><a class="reference internal" href="../_downloads/interpol_01.py">open or download this file: interpol_01.py</a></div><div class="code highlight-python"><div class="highlight"><pre>interpolating result_0.000000
interpolating result_0.100000
interpolating result_0.200000
interpolating result_0.300000
interpolating result_0.400000
interpolating result_0.500000
interpolating result_0.600000
interpolating result_0.700000
interpolating result_0.800000
interpolating result_0.900000
</pre></div>
</div>
<img alt="../_images/glyphinterpol.gif" src="../_images/glyphinterpol.gif" />
<p>Here you see a range of resulting glyphs as they could be generated by the script above.</p>
</div>
<div class="section" id="rounding-errors">
<h2>Rounding errors<a class="headerlink" href="#rounding-errors" title="Permalink to this headline">¶</a></h2>
<p>When you interpolate in FontLab you need to take into account that the results will be rounded off. Coordinates can only consist of whole numbers, i,e, <code class="docutils literal"><span class="pre">101</span></code> or <code class="docutils literal"><span class="pre">102</span></code> but not <code class="docutils literal"><span class="pre">101.3290</span></code> There is a nice solution for working with floating point precision glyphs using RoboFab. Here&#8217;s a brief introduction:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># robothon06</span>

<span class="kn">from</span> <span class="nn">robofab.world</span> <span class="kn">import</span> <span class="n">CurrentFont</span>

<span class="c"># We need to import a class with a different</span>
<span class="c"># implementation for the glyph object.</span>
<span class="c"># It looks a bit odd, but this is how it is done</span>
<span class="kn">from</span> <span class="nn">robofab.objects.objectsRF</span> <span class="kn">import</span> <span class="n">RGlyph</span> <span class="k">as</span> <span class="n">_RGlyph</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">CurrentFont</span><span class="p">()</span>

<span class="c"># pick two compatible glyphs as masters</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;A&quot;</span><span class="p">]</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;B&quot;</span><span class="p">]</span>

<span class="c"># make a new glyph object from this other glyph class</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">_RGlyph</span><span class="p">()</span>

<span class="c"># interpolation factor which is  bound to make floats</span>
<span class="n">oddFactor</span> <span class="o">=</span> <span class="mf">0.2382345</span>

<span class="c"># go!</span>
<span class="n">g</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">oddFactor</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>

<span class="c"># let&#39;s have a look at the raw results</span>
<span class="k">for</span> <span class="n">contour</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">contour</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;float&quot;</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">y</span>

<span class="c"># a glyph can round itself off:</span>
<span class="n">g</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>

<span class="c"># and then it looks like integers again</span>
<span class="k">for</span> <span class="n">contour</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">contour</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;integer&quot;</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">y</span>
</pre></div>
</div>
<div class="downloadlink"><a class="reference internal" href="../_downloads/interpol_02.py">open or download this file: interpol_02.py</a></div><div class="code highlight-python"><div class="highlight"><pre>float glyph 285.07676 114.59806
float glyph 641.51202 285.66048
float glyph 452.009385 679.5407
float glyph 95.96647 508.47828
integer glyph 285 115
integer glyph 642 286
integer glyph 452 680
integer glyph 96 508
</pre></div>
</div>
<p>Use <code class="docutils literal"><span class="pre">font.insertGlyph(myOrphanFloatGlyph,</span> <span class="pre">name=&quot;someName&quot;)</span></code> if you want to insert the glyph back into a real font. Inserting causes the glyph points to be rounded off again. In a similar way you can make a font object which does not refer to an open FontLab font. In such a font you can store intermediate floating point glyphs of interpolations.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">as</span></code> parameter in <code class="docutils literal"><span class="pre">insertGlyph</span></code> changed to <code class="docutils literal"><span class="pre">name</span></code> as of RoboFab svn version 200. As of python 2.6 <code class="docutils literal"><span class="pre">as</span></code> is now a reserved keyword.</p>
</div>
</div>
<div class="section" id="making-it-work">
<h2>Making it work<a class="headerlink" href="#making-it-work" title="Permalink to this headline">¶</a></h2>
<p>The following table shows the problems glyphs can have when interpolating. <strong>Compatible</strong> means that the data can interpolate. <strong>Functioning</strong> means that the result actually works as a glyph. You&#8217;ll see there are several combinations where glyphs are compatible, but the interpolation is not functional.</p>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="29%" />
<col width="29%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">masters</th>
<th class="head">result</th>
<th class="head">fix</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><img alt="../_images/compatibility-scheme_2_01.gif" class="first last" src="../_images/compatibility-scheme_2_01.gif" />
</td>
<td>Compatible and functioning. Same
number of points, same direction,
same start point location.</td>
<td>&#8211;</td>
</tr>
<tr class="row-odd"><td><img alt="../_images/compatibility-scheme_2_02.gif" class="first last" src="../_images/compatibility-scheme_2_02.gif" />
</td>
<td>Unusual, but compatible and
functioning. The number of off-curve
points differ, but these are assumed
to be on top of the on-curve when
missing. Note: this only works for
segments with 2 off-curve points.</td>
<td>&#8211;</td>
</tr>
<tr class="row-even"><td><img alt="../_images/compatibility-scheme_2_03.gif" class="first last" src="../_images/compatibility-scheme_2_03.gif" />
</td>
<td>Compatible and functioning. Same
number of points, same direction,
same start point location, same
contour order.</td>
<td>&#8211;</td>
</tr>
<tr class="row-odd"><td><img alt="../_images/compatibility-scheme_2_04.gif" class="first last" src="../_images/compatibility-scheme_2_04.gif" />
</td>
<td>Incompatible and not functioning:
different number of points.</td>
<td>Edit the masters.</td>
</tr>
<tr class="row-even"><td><img alt="../_images/compatibility-scheme_2_05.gif" class="first last" src="../_images/compatibility-scheme_2_05.gif" />
</td>
<td>Compatible but not functioning:
start point is in the wrong place.</td>
<td>apply <code class="docutils literal"><span class="pre">c.autoStartSegment()</span></code>
on each contour, otherwise
edit the masters.</td>
</tr>
<tr class="row-odd"><td><img alt="../_images/compatibility-scheme_2_06.gif" class="first last" src="../_images/compatibility-scheme_2_06.gif" />
</td>
<td>Incompatible and not functioning:
different number of contours</td>
<td>Edit the masters.</td>
</tr>
<tr class="row-even"><td><img alt="../_images/compatibility-scheme_2_07.gif" class="first last" src="../_images/compatibility-scheme_2_07.gif" />
</td>
<td>Compatible but not functioning: one
of the contours is turning in the
wrong direction.</td>
<td>apply <code class="docutils literal"><span class="pre">glyph.correctDirection()</span></code>,
otherwise edit the masters.</td>
</tr>
<tr class="row-odd"><td><img alt="../_images/compatibility-scheme_2_08.gif" class="first last" src="../_images/compatibility-scheme_2_08.gif" />
</td>
<td>Compatible but not functioning.
Contour order: the paths are in the
wrong order.</td>
<td>apply <code class="docutils literal"><span class="pre">glyph.autoContourOrder()</span></code>,
otherwise edit the masters.</td>
</tr>
</tbody>
</table>
<p>Here are some snippets which can help prepare your glyphs. Suppose your test font has two incompatible glyphs <code class="docutils literal"><span class="pre">A</span></code> and <code class="docutils literal"><span class="pre">B</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># see if &quot;A&quot; and &quot;B&quot; can interpolate</span>
<span class="kn">from</span> <span class="nn">robofab.world</span> <span class="kn">import</span> <span class="n">CurrentFont</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">CurrentFont</span><span class="p">()</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">]</span>
<span class="k">print</span> <span class="n">a</span><span class="o">.</span><span class="n">isCompatible</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="downloadlink"><a class="reference internal" href="../_downloads/interpol_03.py">open or download this file: interpol_03.py</a></div><div class="code highlight-python"><div class="highlight"><pre><span class="bp">False</span>
</pre></div>
</div>
<p>So, there&#8217;s the answer in code, they can&#8217;t interpolate. Suppose the glyphs were in fact compatible, the answer will read True. The <code class="docutils literal"><span class="pre">isCompatible()</span></code> method takes another parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># see if &quot;A&quot; and &quot;B&quot; can interpolate</span>
<span class="c"># and find out what&#39;s wrong if you can</span>
<span class="kn">from</span> <span class="nn">robofab.world</span> <span class="kn">import</span> <span class="n">CurrentFont</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">CurrentFont</span><span class="p">()</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">]</span>
<span class="k">print</span> <span class="n">a</span><span class="o">.</span><span class="n">isCompatible</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="downloadlink"><a class="reference internal" href="../_downloads/interpol_04.py">open or download this file: interpol_04.py</a></div><div class="code highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;Fatal error: contour 1 in glyph A and glyph B don&#39;t have the same number of segments.&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Apart from the stunted grammar, this will tell you more or less what&#8217;s wrong with the two glyphs. Now you have something to fix. Another frequently found error is this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;Fatal error: glyph A and glyph B don&#39;t have the same number of contours.&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>More subtle errors happen when one of the contours in one of the masters turns in the wrong direction, or the start point of the contour is in a different place. These won&#8217;t trip incompatibility errors like ones above, you have to verify the results.</p>
<p>The following example shows methods which can help to make glyph more compatible. These methods use rules to arrange the starting point, the order of the contours and the direction of the contours. It is likely, but not garanteed, that other masters of your interpolation will respond the same way to these rules. For instance, <code class="docutils literal"><span class="pre">autoStartSegment()</span></code> moves the starting point of a contour to the most, bottom left point on the contour. If all your masters share the same structure, this will make sense. But if the masters are radically different on purpose, these rules won&#8217;t produce the right results and you have to prepare the glyphs manually:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># robothon06</span>
<span class="c"># prepare glyph for interpolation</span>
<span class="c"># move startpoints</span>
<span class="c"># fix directions</span>
<span class="c"># fix contour order</span>

<span class="kn">from</span> <span class="nn">robofab.world</span> <span class="kn">import</span> <span class="n">CurrentFont</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">CurrentFont</span><span class="p">()</span>
<span class="n">glyph</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;A&quot;</span><span class="p">]</span>

<span class="n">glyph</span><span class="o">.</span><span class="n">autoContourOrder</span><span class="p">()</span>
<span class="n">glyph</span><span class="o">.</span><span class="n">correctDirection</span><span class="p">()</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">glyph</span><span class="o">.</span><span class="n">contours</span><span class="p">:</span>
    <span class="n">c</span><span class="o">.</span><span class="n">autoStartSegment</span><span class="p">()</span>
<span class="n">glyph</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<div class="downloadlink"><a class="reference internal" href="../_downloads/interpol_05.py">open or download this file: interpol_05.py</a></div></div>
<div class="section" id="interpolating-fonts">
<h2>Interpolating fonts<a class="headerlink" href="#interpolating-fonts" title="Permalink to this headline">¶</a></h2>
<p>The following script interpolates two fonts and stores the results in a third. It also smoothly introduces a couple of simple user interface thingies: <code class="docutils literal"><span class="pre">AskString</span></code> and <code class="docutils literal"><span class="pre">SelectFont</span></code>. Have a look at the <a class="reference internal" href="../intro/dialogs.html"><em>how to page on the simple dialogs stuff</em></a>. <code class="docutils literal"><span class="pre">AskString()</span></code> presents a small dialogbox with a prompt and a text input box. It will return the value you typed in, or None if you didn&#8217;t. Which kinda implies you need to check whether the input makes sense before continuing, but that&#8217;s a different project. <code class="docutils literal"><span class="pre">SelectFont()</span></code> gives you simple dialog with a list of the currently open fonts. When you select a font name, the object for that font is returned. If you don&#8217;t select anything, <code class="docutils literal"><span class="pre">None</span></code> is returned:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># robothon06</span>
<span class="c"># interpolate two fonts</span>

<span class="kn">from</span> <span class="nn">robofab.world</span> <span class="kn">import</span> <span class="n">SelectFont</span><span class="p">,</span> <span class="n">NewFont</span>
<span class="kn">from</span> <span class="nn">robofab.interface.all.dialogs</span> <span class="kn">import</span> <span class="n">AskString</span>

<span class="n">font1</span> <span class="o">=</span> <span class="n">SelectFont</span><span class="p">(</span><span class="s">&quot;Select font 1&quot;</span><span class="p">)</span>
<span class="n">font2</span> <span class="o">=</span> <span class="n">SelectFont</span><span class="p">(</span><span class="s">&quot;Select font 2&quot;</span><span class="p">)</span>

<span class="n">value</span> <span class="o">=</span> <span class="n">AskString</span><span class="p">(</span><span class="s">&quot;What percentage?&quot;</span><span class="p">)</span>
<span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mo">01</span>

<span class="n">destination</span> <span class="o">=</span> <span class="n">NewFont</span><span class="p">()</span>

<span class="c"># this interpolates the glyphs</span>
<span class="n">destination</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">font1</span><span class="p">,</span> <span class="n">font2</span><span class="p">,</span> <span class="n">doProgress</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># this interpolates the kerning</span>
<span class="c"># comment this line out of you&#39;re just testing</span>
<span class="n">destination</span><span class="o">.</span><span class="n">kerning</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">font1</span><span class="o">.</span><span class="n">kerning</span><span class="p">,</span> <span class="n">font2</span><span class="o">.</span><span class="n">kerning</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="n">destination</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<div class="downloadlink"><a class="reference internal" href="../_downloads/interpol_06.py">open or download this file: interpol_06.py</a></div><p>This script asks you to select 2 fonts, then it asks you for an interpolation factor. Then is creates a new font (in FontLab a new empty font window will pop up). Then the <code class="docutils literal"><span class="pre">font.interpolate()</span></code> method of this new font is called with the interpolation factor you entered before, and the two fonts you selected.</p>
</div>
<div class="section" id="interpolate-kerning">
<h2>Interpolate Kerning<a class="headerlink" href="#interpolate-kerning" title="Permalink to this headline">¶</a></h2>
<p>In the example above the kerning is interpolated separately, the Kerning object has its own <code class="docutils literal"><span class="pre">interpolate()</span></code> method. When a kernpair exists in both masters, the resulting pair will be the expected interpolated value. If a pair is missing from one, the interpolation will assume it has value <code class="docutils literal"><span class="pre">0</span></code>. This only works for flat, non-class kerning. Interpolating class based kerning with exceptions requires more attention. Some Robofab developers have this working though.</p>
</div>
<div class="section" id="glyphmath-aside-1">
<h2>GlyphMath (aside 1)<a class="headerlink" href="#glyphmath-aside-1" title="Permalink to this headline">¶</a></h2>
<p>If they&#8217;re compatible, Robofab Glyph objects can be used in Python math expression: you can add, subtract, multiply and divide them like normal numbers or variables. The math is applied to the coordinates of each point in the glyph. The result of a glyphMath operation is a new glyph. You can then insert this glyph in a font, or use it for other math operations.</p>
<table border="1" class="docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">GlyphMath</th>
<th class="head">operation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><img alt="../_images/glyphmath_examples_01.gif" class="first last" src="../_images/glyphmath_examples_01.gif" />
</td>
<td><strong>addition</strong>: the coordinates of each point are added</td>
</tr>
<tr class="row-odd"><td><img alt="../_images/glyphmath_examples_02.gif" class="first last" src="../_images/glyphmath_examples_02.gif" />
</td>
<td><strong>subtraction</strong>: the coordinates of each point are
subtracted. Note that though the glyph looks
unrecognisable, all points are still there.
Literally the difference between the two glyphs.</td>
</tr>
<tr class="row-even"><td><img alt="../_images/glyphmath_examples_03.gif" class="first last" src="../_images/glyphmath_examples_03.gif" />
</td>
<td><strong>multiplication</strong>: scaling the glyph up. When you
multiply with a tuple like <code class="docutils literal"><span class="pre">(1.3,</span> <span class="pre">1.05)</span></code> the first
value is used to multiply the <code class="docutils literal"><span class="pre">x</span></code> coordinates, the
second value is used for the <code class="docutils literal"><span class="pre">y</span></code> coordinates.</td>
</tr>
<tr class="row-odd"><td><img alt="../_images/glyphmath_examples_04.gif" class="first last" src="../_images/glyphmath_examples_04.gif" />
</td>
<td><strong>division</strong>: scaling the glyph down. When you divide
with a tuple like <code class="docutils literal"><span class="pre">(30,</span> <span class="pre">29)</span></code> the first value is used
to divide the <code class="docutils literal"><span class="pre">x</span></code> coordinates, the second value is
used for the <code class="docutils literal"><span class="pre">y</span></code> coordinates.</td>
</tr>
<tr class="row-even"><td><img alt="../_images/glyphmath_examples_05.gif" class="first last" src="../_images/glyphmath_examples_05.gif" />
</td>
<td>Combination of operations to make a real
interpolation.</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># glyphmath example, using glyphs in math</span>
<span class="c"># in the test font: two interpolatable, different glyphs</span>
<span class="c"># on positions A and B.</span>
 
<span class="kn">from</span> <span class="nn">robofab.world</span> <span class="kn">import</span> <span class="n">CurrentFont</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">CurrentFont</span><span class="p">()</span>
 
<span class="c"># glyphmath</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;A&quot;</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;B&quot;</span><span class="p">]</span>
 
<span class="c"># multiply works as scaling up</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">2</span>
<span class="c"># or</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a</span>
 
<span class="c"># note: as of robofab svn version 200,</span>
<span class="c"># the &quot;as&quot; argument in insertGlyph has changed to &quot;name&quot;</span>
<span class="n">f</span><span class="o">.</span><span class="n">insertGlyph</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;A.A_times_2&quot;</span><span class="p">)</span>
 
<span class="c"># division works as scaling down</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">f</span><span class="o">.</span><span class="n">insertGlyph</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;A.A_divide_2&quot;</span><span class="p">)</span>
 
<span class="c"># addition: add coordinates of each point</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="n">f</span><span class="o">.</span><span class="n">insertGlyph</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;A.A_plus_B&quot;</span><span class="p">)</span>
 
<span class="c"># subtraction: subtract coordinates of each point</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
<span class="n">f</span><span class="o">.</span><span class="n">insertGlyph</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;A.A_minus_B&quot;</span><span class="p">)</span>
 
<span class="c"># combination: interpolation!</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">insertGlyph</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;A.A_interpolate_B&quot;</span><span class="p">)</span>
 
<span class="n">f</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<div class="downloadlink"><a class="reference internal" href="../_downloads/interpol_07.py">open or download this file: interpol_07.py</a></div><p>You can use GlyphMath to create interpolation effects, transplant transformations from one glyph to another and superimpose several effects at once.</p>
</div>
<div class="section" id="superpolation-aside-2">
<h2>Superpolation (aside 2)<a class="headerlink" href="#superpolation-aside-2" title="Permalink to this headline">¶</a></h2>
<p>Shameless commercial: <a class="reference external" href="http://superpolator.com/">Superpolator</a> is a tool for building complex interpolation systems. It&#8217;s based on Robofab and doesn&#8217;t really have a place in this presentation. It doesn&#8217;t make complex interpolations easier, it makes them possible. But ask Erik afterwards.</p>
</div>
<div class="section" id="advanced-interpolation">
<h2>Advanced Interpolation<a class="headerlink" href="#advanced-interpolation" title="Permalink to this headline">¶</a></h2>
<p>Here are two more advanced examples of interpolation. The first script asks for two master fonts. Then it will generate a list of weights with predefined names and factors. After interpolating, it will close the result font and continue with the next weight:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># robothon06</span>
<span class="c"># interpolate two fonts with a series of factors.</span>
<span class="c"># for each factor create a new font file.</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">robofab.world</span> <span class="kn">import</span> <span class="n">SelectFont</span><span class="p">,</span> <span class="n">NewFont</span>
<span class="kn">from</span> <span class="nn">robofab.interface.all.dialogs</span> <span class="kn">import</span> <span class="n">AskString</span><span class="p">,</span> <span class="n">GetFolder</span>

<span class="n">font1</span> <span class="o">=</span> <span class="n">SelectFont</span><span class="p">(</span><span class="s">&quot;Select font 1&quot;</span><span class="p">)</span>
<span class="n">font2</span> <span class="o">=</span> <span class="n">SelectFont</span><span class="p">(</span><span class="s">&quot;Select font 2&quot;</span><span class="p">)</span>
<span class="n">where</span> <span class="o">=</span> <span class="n">GetFolder</span><span class="p">(</span><span class="s">&quot;Select a folder to save the interpolations&quot;</span><span class="p">)</span>

<span class="n">instances</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s">&quot;Light&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;NotTooLight&quot;</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;Regular&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;Demi&quot;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&quot;Medium&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
    <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">thing</span>
    <span class="k">print</span> <span class="s">&quot;generating&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span>
    <span class="n">dst</span> <span class="o">=</span> <span class="n">NewFont</span><span class="p">()</span>
    <span class="c"># this interpolates the glyphs</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">font1</span><span class="p">,</span> <span class="n">font2</span><span class="p">,</span> <span class="n">doProgress</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="c"># this interpolates the kerning</span>
    <span class="c"># comment this line out of you&#39;re just testing</span>
    <span class="c">#dst.kerning.interpolate(font1.kerning, font2.kerning, value)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">familyName</span> <span class="o">=</span> <span class="s">&quot;MyBigFamily&quot;</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">styleName</span> <span class="o">=</span> <span class="n">name</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">autoNaming</span><span class="p">()</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
    <span class="n">fileName</span> <span class="o">=</span> <span class="n">dst</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">familyName</span> <span class="o">+</span> <span class="s">&quot;-&quot;</span> <span class="o">+</span> <span class="n">dst</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">styleName</span> <span class="o">+</span> <span class="s">&quot;.vfb&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">where</span><span class="p">,</span> <span class="n">fileName</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;saving at&#39;</span><span class="p">,</span> <span class="n">path</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="downloadlink"><a class="reference internal" href="../_downloads/interpol_08.py">open or download this file: interpol_08.py</a></div><p>The next script is a bit tricky, but it can be useful tool in typedesign. Suppose you have a two interpolating masters of different weights. The script interpolates <strong>in horizontal direction</strong> with the heavy weight to increase the stem thickness of the glyph. Then it proceeds to horizontally scale the glyph in such a way that the increase of weight from the interpolation is reduced again. The effect of both operations is a condensed version of the original glyph, but with a comparable stem thickness as the original. If you measure the stems of both masters and enter the values in the script, it can calculate an exact match. Note that the success of this script depends on the quality of the interpolation, and how far you&#8217;re pushing the limit. From a design point of view you might not even want the condensed to have the same stem thickness. This script won&#8217;t produce ready-made condensed versions of your typeface, but it can be used to create a starting point for further editing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># robothon06</span>
<span class="c"># Get started with a condensed if you have a regular and a bold:</span>
<span class="c"># seperate x, y interpolation to make stems fatter</span>
<span class="c"># then scaling to reduce width</span>
<span class="c"># stems will get their original thickness</span>

<span class="kn">from</span> <span class="nn">robofab.world</span> <span class="kn">import</span> <span class="n">CurrentFont</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">CurrentFont</span><span class="p">()</span>

<span class="c"># these are measurements you have to take</span>
<span class="c"># from your font. The width of a stem.</span>

<span class="n">lightStem</span> <span class="o">=</span> <span class="mi">106</span>
<span class="n">fatStem</span> <span class="o">=</span> <span class="mi">200</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;result_</span><span class="si">%f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">factor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lightStem</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">lightStem</span> <span class="o">+</span> <span class="n">factor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">fatStem</span> <span class="o">-</span> <span class="n">lightStem</span><span class="p">))</span>
    <span class="k">print</span> <span class="n">factor</span><span class="p">,</span> <span class="n">scale</span>
    <span class="n">f</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;A&quot;</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;B&quot;</span><span class="p">])</span>
    <span class="n">f</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">scale</span><span class="p">((</span><span class="n">scale</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">f</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">leftMargin</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">leftMargin</span>
    <span class="n">f</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">rightMargin</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rightMargin</span>
<span class="n">f</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<div class="downloadlink"><a class="reference internal" href="../_downloads/interpol_09.py">open or download this file: interpol_09.py</a></div></div>
</div>


</div>
    </div>
</div>

      <div class="clearer"></div>
    </div>
<div id='tocsidebar'>
<h3>links</h3>
<ul>
<li><a href='https://github.com/robofab-developers/robofab'>robofab source</a></li>
<li><a href='http://groups.google.com/group/robofab'>mailing list</a></li>
</ul>
<h3>more links</h3>
<ul>
<li><a href='http://sourceforge.net/projects/fonttools/'>FontTools/TTX</a></li>
<li><a href='http://tools.typesupply.com/'>TypeSupply</a></li>
<li><a href='http://superpolator.com/'>Superpolator</a></li>
<li><a href='http://letterror.com/'>LettError</a></li>
</ul>
</div>

<div class="footer">
<p>&copy; Copyright <script>document.write(new Date().getFullYear())</script>
    <a href="http://letterror.com/">Just van Rossum</a>, <a href="http://letterror.com/">Erik van Blokland</a>, <a href="http://typesupply.com/">Tal Leming</a>.</p>
<p>
Last updated on Nov 13, 2015. 
Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
</p>
</div>
  </body>
</html>